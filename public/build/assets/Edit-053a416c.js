import{W as T,j as e}from"./app-4a46fc6f.js";import{S as d}from"./react-select.esm-21bc4562.js";import{D as q}from"./DashboardLayout-479ce328.js";import{B}from"./Breadcrumb-aa69014e.js";import{F as i}from"./FieldGroup-136c92f3.js";import{T as u}from"./TextInput-db2ab464.js";import{P as F}from"./PrimaryButton-0a64fb3a.js";import{c as m}from"./ReactSelectOption-49a86ad9.js";import{P as O}from"./plus-06b3f79a.js";import{T as R}from"./trash-2-3dd3058b.js";import"./createLucideIcon-9557887a.js";import"./graduation-cap-39a9194c.js";const M=({user:p,roles:f,depts:b,bus:j,positions:v,pivots:x})=>{const g=[{link:route("dashboard"),text:"Dashboard"},{link:route("users.index"),text:"User"}],{full_name:_,username:N,has_role:h,email:w,no_hp:k,no_nik:S,has_depts:y}=p,{data:r,setData:o,patch:P,errors:n,processing:C}=T({full_name:_,username:N,role:h[0].id,roleSelected:m(h),email:w,no_hp:k,no_nik:S,password:"",pivot:x.map(a=>{const l=y.map(s=>s.id);return{bu:a.bu.id,buSelected:{value:a.bu.id,label:a.bu.name},positions:a.positions.map(s=>s.id),positionSelected:m(a.positions),depts:l,deptOptions:m(b.filter(s=>s.bu_id===a.bu.id)),deptSelected:m(b.filter(s=>s.bu_id===a.bu.id&&l.includes(s.id)))}})}),$=()=>{o("pivot",[...r.pivot,{bu:null,position:[]}])},U=a=>{const l=r.pivot.filter((s,t)=>t!==a);o("pivot",l)},D=a=>{o(l=>({...l,role:a.value,roleSelected:a}))},E=a=>{a.preventDefault(),P(route("users.update",p))};return e.jsxs("form",{onSubmit:E,className:"w-full",children:[e.jsxs("div",{className:"content-box",children:[e.jsx(B,{title:"Edit User",pageName:"Edit",prevPage:g}),e.jsx(i,{label:"Full Name",name:"full_name",error:n.full_name,isPrimary:!0,children:e.jsx(u,{name:"full_name",className:"mt-1 block w-full",value:r.full_name,onChange:a=>o("full_name",a.target.value),required:!0,isFocused:!0,autoComplete:"full_name",placeholder:"Full Name..."})}),e.jsx(i,{label:"Username",name:"username",error:n.username,isPrimary:!0,children:e.jsx(u,{name:"username",className:"mt-1 block w-full",value:r.username,onChange:a=>o("username",a.target.value),required:!0,autoComplete:"username",placeholder:"Username..."})}),e.jsx(i,{label:"Roles",name:"role",error:n.role,isPrimary:!0,children:e.jsx(d,{options:m(f),value:r.roleSelected,onChange:D})}),e.jsx(i,{label:"User Email",name:"email",error:n.email,isPrimary:!0,children:e.jsx(u,{name:"email",type:"email",className:"mt-1 block w-full",value:r.email,onChange:a=>o("email",a.target.value),required:!0,autoComplete:"email",placeholder:"User Email..."})}),e.jsx(i,{label:"User Phone",name:"no_hp",error:n.no_hp,isPrimary:!0,children:e.jsx(u,{name:"no_hp",className:"mt-1 block w-full",value:r.no_hp,onChange:a=>o("no_hp",a.target.value),required:!0,autoComplete:"no_hp",placeholder:"Handphone Number..."})}),e.jsx(i,{label:"User NIK",name:"no_nik",error:n.no_nik,isPrimary:!0,children:e.jsx(u,{name:"no_nik",className:"mt-1 block w-full",value:r.no_nik,onChange:a=>o("no_nik",a.target.value),required:!0,autoComplete:"no_nik",placeholder:"NIK..."})}),e.jsx(i,{label:"Password",name:"password",error:n.password,children:e.jsx(u,{type:"password",name:"password",className:"mt-1 block w-full",value:r.password,onChange:a=>o("password",a.target.value),autoComplete:"password",placeholder:"Password..."})}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("button",{className:"btn btn--primary text-black font-semibold",type:"button",onClick:$,children:[e.jsx(O,{className:"inline-block mb-1"})," Add Positioning"]}),e.jsx(F,{disabled:C,children:"Submit"})]})]}),r.pivot.map((a,l)=>e.jsx("div",{className:"content-box mt-2 z-0",children:e.jsxs("div",{className:"py-2 border-b border-gray-300",children:[e.jsx(i,{label:"Business Unit",name:`pivot.${l}.bu`,error:n[`pivot.${l}.bu`],children:e.jsxs("div",{className:"flex flex-row items-end gap-x-2",children:[e.jsx(d,{name:`pivot.${l}.bu`,placeholder:"Select Type...",options:m(j),value:a.buSelected,onChange:async s=>{const t=[...r.pivot];t[l].bu=s.value,t[l].buSelected=s,t[l].depts=[],t[l].deptSelected=[];const c=await axios.get(`/getBuDept/${s.value}`);t[l].deptOptions=c.data,o("pivot",t)},className:"mt-1 block w-full"}),e.jsx("button",{className:"btn-sm btn--danger",type:"button",onClick:()=>U(l),children:e.jsx(R,{})})]})}),e.jsx(i,{label:"Position",name:`pivot.${l}.position`,error:n[`pivot.${l}.position`],children:e.jsx(d,{isMulti:!0,name:`pivot.${l}.position`,placeholder:"Select Type...",options:m(v),value:a.positionSelected,onChange:s=>{const t=[...r.pivot];t[l].positions=s.map(c=>c.value),t[l].positionSelected=s,o("pivot",t)},className:"mt-1 block w-full"})}),e.jsx(i,{label:"Department",name:`pivot.${l}.dept`,error:n[`pivot.${l}.dept`],children:e.jsx(d,{isMulti:!0,name:`pivot.${l}.dept`,placeholder:"Select Department...",options:r.pivot[l].deptOptions||[],value:a.deptSelected,onChange:s=>{const t=[...r.pivot];t[l].depts=s.map(c=>c.value),t[l].deptSelected=s,o("pivot",t)},className:"mt-1 block w-full",menuPortalTarget:document.body,menuPosition:"fixed"})})]})},l))]})};M.layout=p=>e.jsx(q,{title:"User Edit",children:p});export{M as default};
